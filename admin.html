<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>تقرير شيك ليست الريمين</title>
<style>
  body {font-family: Arial; margin:20px;background:#f5f5f5;}
  table {width:100%;border-collapse:collapse;margin-top:20px;}
  th, td {border:1px solid #ccc;padding:10px;text-align:center;}
  th {background:#007bff;color:#fff;}
  input, button {padding:10px;margin:5px;}
  button {background:#28a745;color:#fff;border:none;border-radius:5px;cursor:pointer;}
</style>
</head>
<body>
<h2 style="text-align:center;">تقرير شيك ليست الريمين</h2>

<label>من: <input type="date" id="from"></label>
<label>إلى: <input type="date" id="to"></label>
<button id="load">عرض التقرير</button>
<button onclick="window.print()">طباعة</button>

<h3>إجمالي المبلغ: <span id="total">0</span></h3>

<table id="reportTable">
  <thead>
    <tr>
      <th>اسم الممرضة</th>
      <th>الشفت</th>
      <th>التاريخ</th>
      <th>اسم المريض</th>
      <th>المبلغ</th>
      <th>الشركة</th>
      <th>الرقم</th>
      <th>سبب الريمين</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
const FORM_URL = "https://script.google.com/macros/s/AKfycbzOBsMwZits0tPbn2XnCnlZJY3Zcr-5uygxwfl-a1z3RyNHHOmzpGKAb_VNudooy2ge/exec";

document.getElementById('load').addEventListener('click', async ()=>{
  const from = document.getElementById('from').value;
  const to = document.getElementById('to').value;
  let url = FORM_URL;
  if(from && to) url += `?from=${from}&to=${to}`;
  
  const res = await fetch(url);
  const data = await res.json();
  
  const tbody = document.querySelector('#reportTable tbody');
  tbody.innerHTML = '';
  let total = 0;
  
  data.forEach(row=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${row['اسم الممرضة']}</td>
      <td>${row['الشفت']}</td>
      <td>${row['التاريخ']}</td>
      <td>${row['اسم المريض']}</td>
      <td>${row['المبلغ']}</td>
      <td>${row['الشركة']}</td>
      <td>${row['الرقم']}</td>
      <td>${row['سبب الريمين']}</td>
    `;
    tbody.appendChild(tr);
    total += Number(row['المبلغ']) || 0;
  });
  document.getElementById('total').textContent = total;
});
</script>
</body>
</html>
